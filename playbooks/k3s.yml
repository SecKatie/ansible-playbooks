---
# =============================================================================
# K3s Cluster Configuration Playbook
# =============================================================================
# This playbook configures K3s cluster agents on RHEL nodes.
#
# Usage:
#   ansible-playbook -i inventory/hosts.yml playbooks/k3s.yml
#
# Tags:
#   - k3s: All K3s configuration tasks
#   - k3s_agents: K3s agent joining tasks
#   - k3s_agent: Individual agent role
# =============================================================================

- name: Join RHEL nodes to K3s cluster as agents
  hosts: rhel_k3s_agents
  become: true
  gather_facts: true
  tags: [k3s, k3s_agents]
  roles:
    - role: infra_k3s_agent
      tags: [k3s_agent]

  post_tasks:
    - name: Display join completion message
      ansible.builtin.debug:
        msg: "{{ inventory_hostname }} has been joined to the k3s cluster"
